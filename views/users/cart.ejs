<!DOCTYPE html>
<html lang="en">
  <!-- Mirrored from htmldemo.net/furbar-1/furbar/shop-grid-4-column.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 14 Dec 2023 16:16:16 GMT -->
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="x-ua-compatible" content="ie=edge" />
    <title>Furbar - Furniture eCommerce Bootstrap 5 Template</title>
    <meta name="robots" content="noindex, follow" />
    <meta name="description" content="" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />
    <!-- Favicon -->
    <link
      rel="shortcut icon"
      type="image/x-icon"
      href="assets/images/favicon.png"
    />

    <!-- CSS
	============================================ -->

    <!-- Icon Font CSS -->
    <link rel="stylesheet" href="assets/css/plugins/pe-icon-7-stroke.css" />
    <link rel="stylesheet" href="assets/css/plugins/font-awesome.min.css" />

    <!-- Plugins CSS -->
    <link rel="stylesheet" href="assets/css/plugins/bootstrap.min.css" />
    <link rel="stylesheet" href="assets/css/plugins/animate.min.css" />
    <link rel="stylesheet" href="assets/css/plugins/swiper-bundle.min.css" />
    <link rel="stylesheet" href="assets/css/plugins/odometer.min.css" />
    <link rel="stylesheet" href="assets/css/plugins/select2.min.css" />
    <link rel="stylesheet" href="assets/css/plugins/ion.rangeSlider.min.css" />

    <!-- Main Style CSS -->
    <!-- <link rel="stylesheet" href="assets/css/style.css"> -->
    <link rel="stylesheet" href="assets/css/style.min.css" />
  </head>

  <body>
    <!-- Header Start  -->
    <div class="header-area header-sticky d-none d-lg-block">
      <div class="container position-relative">
          <div class="row align-items-center">
              <div class="col-lg-3">
                  <!-- Header Logo Start -->
                  <div class="header-logo">
                      <a href="index.html"><img src="assets/images/logo.png" width="154" height="46" alt="Logo" /></a>
                  </div>
                  <!-- Header Logo End -->
              </div>
              <div class="col-lg-6">
                  <div class="header-menu">
                      <ul class="nav-menu">
                          <li>
                              <a href="/">Home</a>
                          </li>
                          <li><a href="/loadShop">Shop</a></li>
                          <li>
                              <a href="/loadProduct">Products</a>
                          </li>
                          <li>
                              <a href="#">About us</a>
                          </li>
                          
                          <li>
                              <a href="#">Blog</a>
                          </li>
                          <li><a href="contact.html">Contact</a></li>
                      </ul>
                  </div>
              </div>
              <div class="col-lg-3">
                  <!-- Header Meta Start -->
                  <div class="header-meta">
                      <div class="dropdown">
                          <a class="action" href="#" role="button" data-bs-toggle="dropdown">
                              <i class="pe-7s-search"></i>
                          </a>

                          <div class="dropdown-menu dropdown-search">
                              <!-- Header Search Start -->
                              <div class="header-search">
                                  <form action="#">
                                      <input type="text" placeholder="Enter your search key ... " />
                                      <button>
                                          <i class="pe-7s-search"></i>
                                      </button>
                                  </form>
                              </div>
                              <!-- Header Search End -->
                          </div>
                      </div>

                      <div class="dropdown">
                          <a class="action" href="#" role="button" data-bs-toggle="dropdown"><i class="pe-7s-user"></i></a>

                          <ul class="dropdown-menu dropdown-profile">
                              <li><a href="/loadProfile">My Account</a></li>
                              <li><a href="login">Sign In</a></li>
                              <li><a href="register">Sign Up</a></li>
                              <li><a href="logout">Logout</a></li>
                          </ul>
                      </div>
                      <a class="action" href="/loadWishlist"><i class="pe-7s-like"></i></a>

                      <div >
                          <a class="action" href="/viewCart" role="button" >
                              <i class="pe-7s-cart"></i>
                              <span class="number">3</span>
                          </a>
                      </div>
                  </div>
                  <!-- Header Meta End -->
              </div>
          </div>
      </div>
  </div>
    <!-- Header End -->

    <!-- Header Mobile Start -->
    <div class="header-mobile section d-lg-none">
      <!-- Header Mobile top Start -->
      <div class="header-mobile-top header-sticky">
        <div class="container">
          <div class="row row-cols-3 gx-2 align-items-center">
            <div class="col">
              <!-- Header Toggle Start -->
              <div class="header-toggle">
                <button
                  class="mobile-menu-open"
                  data-bs-toggle="offcanvas"
                  data-bs-target="#offcanvasMenu"
                >
                  <span></span>
                  <span></span>
                  <span></span>
                </button>
              </div>
              <!-- Header Toggle End -->
            </div>
            <div class="col">
              <!-- Header Logo Start -->
              <div class="header-logo text-center">
                <a href="index.html"
                  ><img
                    src="assets/images/logo.png"
                    width="154"
                    height="46"
                    alt="Logo"
                /></a>
              </div>
              <!-- Header Logo End -->
            </div>
            <div class="col">
              <!-- Header Action Start -->
              <div class="header-meta">
                <div class="dropdown">
                  <a
                    class="action"
                    href="#"
                    role="button"
                    data-bs-toggle="dropdown"
                    ><i class="pe-7s-user"></i
                  ></a>

                  <ul class="dropdown-menu dropdown-profile">
                    <li>
                      <a href="my-account.html">My Account</a>
                    </li>
                    <li><a href="checkout.html">Checkout</a></li>
                    <li><a href="login.html">Sign In</a></li>
                  </ul>
                </div>
                <a class="action" href="cart.html">
                  <i class="pe-7s-shopbag"></i>
                  <span class="number">3</span>
                </a>
              </div>
              <!-- Header Action End -->
            </div>
          </div>
        </div>
      </div>
      <!-- Header Mobile top End -->

      <!-- Header Mobile Bottom End -->
      <div class="header-mobile-bottom">
        <div class="container">
          <!-- Header Search Start -->
          <div class="header-search">
            <form action="#">
              <input type="text" placeholder="Enter your search key ... " />
              <button><i class="pe-7s-search"></i></button>
            </form>
          </div>
          <!-- Header Search End -->
        </div>
      </div>
      <!-- Header Mobile Bottom End -->
    </div>
    <!-- Header Mobile End -->

    <!-- off Canvas Start -->

    <!-- Page Banner Section Start -->
    <div
      class="section"
      style="background-image: url(assets/images/page-banner.jpg)"
    >
      <!-- page-banner-section       deleted class full image-->
      <div class="container">
        <!-- Page Banner Content End -->
        <div class="page-banner-content">
          <h2 class="title"><br /></h2>

          <ul class="breadcrumb">
            <li><a href="index.html">Home</a></li>
            <li class="active">Cart</li>
          </ul>
          <br>
        </div>
        <!-- Page Banner Content End -->
      </div>
    </div>
    <!-- Page Banner Section End -->

    <!-- Shopping Cart Section Start -->
    <div class="section section-padding">
      <div class="container">
        <div class="cart-wrapper">
          <!-- Cart Wrapper Start -->
          <div class="cart-table table-responsive">
            <table class="table">
              <thead>
                <tr>
                  <th class="product-thumb">Image</th>
                  <th class="product-info">product Information</th>
                  <th class="product-quantity">Quantity</th>
                  <th class="product-total-price">Total Price</th>
                  <th class="product-action">Action</th>
                </tr>
              </thead>

              <tbody>
                <% if(cartDetails && cartDetails.products){%>

                  
                <% cartDetails.products.forEach((element,index) => { %>
                <tr id="cartRefresh<%= element.productId._id %>">
                  <td  class="product-thumb">
                    <img
                      src="/productImage/<%= element.productId.img[0] %>"
                      alt=""
                    />
                  </td>
                  <td class="product-info">
                    <h6 class="name">
                      <a href="product-details.html"
                        ><%= element.productId.name %></a
                      >
                    </h6>
                    <div class="product-prices">
                      <span class="old-price">$35.90</span>
                      <span class="sale-price"
                        >$<%= element.productId.price %></span
                      >
                    </div>
                    <div class="product-size-color">
                      <p>Size <span><%= element.productId.size %></span></p>
                      <p>Color <span><%= element.productId.color %></span></p>
                    </div>
                  </td>
                  <td class="quantity">
                    <div class="product-quantity d-inline-flex">
                      <button type="button"  class="sub">-</button>
                      <input
                        type="text"
                        class="quantityInput"
                        id="checkoutQuantity<%= element.productId._id %>"
                        data-product-id="<%= element.productId._id %>"
                        value="<%= element.quantity %>"
                        min="0"
                      max="5"
                      />
                      
                    
                      <button type="button" class="add" id="addButton">+</button>

                    </div>
                    <input type="text" id="quantity<%= element.productId._id %>" value="<%=element.productId.quantity%>" hidden />
                  </td>

                  <td class="product-total-price">
                    <span class="price" id="totalPrice<%= element.productId._id %>">$<%= element.totalAmount %></span>
                  </td>
                  <td class="product-action">
                    <button class="remove" onclick="deleteCartProduct('<%= element.productId._id %>')">
                      <i class="pe-7s-trash"></i>
                  </button>
                  
                  </td>
                </tr>

                <% }); %>
                <% } %>
              </tbody>
            </table>
          </div>
          <!-- Cart Wrapper End -->
          <!-- Cart btn Start -->
          <div class="cart-btn">
            <div class="left-btn">
              <a
                href="shop-grid-left-sidebar.html"
                class="btn btn-dark btn-hover-primary"
                >Continue Shopping</a
              >
            </div>
            <div class="right-btn">
              <a href="#" class="btn btn-outline-dark">Clear Cart</a>
              <!-- <a href="#" class="btn btn-outline-dark">Update Cart</a> -->
            </div>
          </div>
          <!-- Cart btn Start -->
        </div>
        <div class="row">
          <div class="col-lg-4">
            <!-- Cart Shipping Start -->

            <!-- Cart Shipping End -->
          </div>
          <div class="col-lg-4">
            <!-- Cart Shipping Start -->
            <div class="cart-shipping">
              <div class="cart-title">
                <h4 class="title">Coupon Code</h4>
                <p>Enter your coupon code if you have one.</p>
              </div>
              <div class="cart-form">
                <form action="#">
                  <div class="single-form">
                    <input
                      class="form-control"
                      type="text"
                      placeholder="Enter your coupon code.."
                    />
                  </div>
                  <div class="single-form">
                    <button class="btn btn-dark btn-hover-primary">
                      Apply Coupon
                    </button>
                  </div>
                </form>
              </div>
            </div>
            <!-- Cart Shipping End -->
          </div>
          <div class="col-lg-4">
            <!-- Cart Totals Start -->
            <div class="cart-totals">
              <div class="cart-title">
                <h4 class="title">Cart totals</h4>
              </div>
              <div class="cart-total-table">
                <table class="table">
                  <tbody>
                    <tr>
                      <td>
                        <p class="value">Subtotal</p>
                      </td>
                      <td>
                      
                        <p class="price" id="subTotal">£<%= cartTotal %></p>
                      </td>
                    </tr>
                    <tr>
                      <td>
                        <p class="value">Shipping</p>
                      </td>
                      <td>
                        <ul class="shipping-list">
                          <li class="radio">
                            <input
                              type="radio"
                              name="shipping"
                              id="radio1"
                              checked=""
                            />
                            <label for="radio1"><span></span> Flat Rate</label>
                          </li>
                          <li class="radio">
                            <input type="radio" name="shipping" id="radio2" />
                            <label for="radio2"
                              ><span></span> Free Shipping</label
                            >
                          </li>
                          <li class="radio">
                            <input type="radio" name="shipping" id="radio3" />
                            <label for="radio3"
                              ><span></span> Local Pickup</label
                            >
                          </li>
                        </ul>
                      </td>
                    </tr>
                    <tr>
                      <td>
                        <p class="value">Total</p>
                      </td>
                      <td>
                        <p class="price" id="cartTotal">£<%= cartTotal %>.00</p>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>

              <di v class="cart-btn">
                <% if (cartDetails.products && cartDetails.products.length > 0) { %>
                  <a href="/checkout" class="btn btn-dark btn-hover-primary btn-block">Proceed To Checkout</a>
                <% } else { %>
                  <button class="btn btn-dark btn-hover-primary btn-block" disabled>Proceed To Checkout</button>
                <% } %>
              </div>
              

            </div>
            <!-- Cart Totals End -->
          </div>
        </div>
      </div>
    </div>
    <!-- Shopping Cart Section End -->

    <!-- Footer Section Start -->
    <div class="section footer-section">
      <!-- Footer Top Start -->
      <div class="footer-top">
        <div class="container">
          <div class="row">
            <div class="col-xl-2 col-md-4">
              <!-- Footer Logo Start -->
              <div class="footer-logo">
                <a href="index.html"
                  ><img
                    src="assets/images/logo.png"
                    width="154"
                    height="46"
                    alt="Logo"
                /></a>
              </div>
              <!-- Footer Logo End -->
            </div>
            <div class="col-xl-5 col-md-8">
              <!-- Footer Contact & Payment End -->
              <div class="footer-contact-payment">
                <div class="footer-contact">
                  <div class="contact-icon">
                    <img
                      src="assets/images/icon/icon-4.png"
                      width="39"
                      height="46"
                      alt="Icon"
                    />
                  </div>

                  <div class="contact-content">
                    <h6 class="title">Call Us:</h6>
                    <p>00 123 456 789</p>
                  </div>
                </div>
                <div class="footer-payment">
                  <img
                    src="assets/images/payment.png"
                    width="192"
                    height="21"
                    alt="Payment"
                  />
                </div>
              </div>
              <!-- Footer Contact & Payment End -->
            </div>
            <div class="col-xl-5">
              <!-- Footer Subscribe End -->
              <div class="footer-subscribe">
                <span class="title">Subscribe Now :</span>
                <div class="subscribe-form">
                  <form action="#">
                    <input type="text" placeholder="Your Mail" />
                    <button>
                      <i class="pe-7s-paper-plane"></i>
                    </button>
                  </form>
                </div>
              </div>
              <!-- Footer Subscribe End -->
            </div>
          </div>
        </div>
      </div>
      <!-- Footer Top End -->

      <!-- Footer Widget Section Start -->
      <div class="footer-widget-section">
        <div class="container">
          <div class="row">
            <div class="col-lg-3 col-md-4 col-sm-6">
              <!-- Footer Widget Start -->
              <div class="footer-widget">
                <h4 class="footer-widget-title">Customer Service</h4>

                <ul class="footer-link">
                  <li><a href="#">Payment Methods</a></li>
                  <li><a href="#">Money-back guarantee!</a></li>
                  <li><a href="#">Returns-Shipping</a></li>
                  <li><a href="#">Terms and conditions</a></li>
                  <li><a href="#">Privacy Policy</a></li>
                </ul>
              </div>
              <!-- Footer Widget End -->
            </div>
            <div class="col-lg-2 col-md-4 col-sm-6">
              <!-- Footer Widget Start -->
              <div class="footer-widget">
                <h4 class="footer-widget-title">Information</h4>

                <ul class="footer-link">
                  <li><a href="about.html">About Furbar</a></li>
                  <li>
                    <a href="shop-grid-4-column.html">How to Shop</a>
                  </li>
                  <li><a href="#">FAQ</a></li>
                  <li><a href="contact.html">Contact us</a></li>
                  <li><a href="login.html">Log in</a></li>
                </ul>
              </div>
              <!-- Footer Widget End -->
            </div>
            <div class="col-lg-2 col-md-4 col-sm-6">
              <!-- Footer Widget Start -->
              <div class="footer-widget">
                <h4 class="footer-widget-title">My Account</h4>

                <ul class="footer-link">
                  <li><a href="register.html">Sign In</a></li>
                  <li><a href="cart.html">View Cart</a></li>
                  <li><a href="wishlist.html">My Wishlist</a></li>
                  <li><a href="#">Track My Order</a></li>
                  <li><a href="#">Help</a></li>
                </ul>
              </div>
              <!-- Footer Widget End -->
            </div>
            <div class="col-lg-2 col-md-5 col-sm-6">
              <!-- Footer Widget Start -->
              <div class="footer-widget">
                <h4 class="footer-widget-title">Our Stores</h4>

                <ul class="footer-link">
                  <li><a href="#">New aYork</a></li>
                  <li><a href="#">London SF</a></li>
                  <li><a href="#">Cockfosters BP</a></li>
                  <li><a href="#">Los Angeles</a></li>
                  <li><a href="#">Chicago</a></li>
                </ul>
              </div>
              <!-- Footer Widget End -->
            </div>
            <div class="col-lg-3 col-md-7">
              <!-- Footer Widget Start -->
              <div class="footer-widget">
                <h4 class="footer-widget-title">About Us</h4>

                <div class="widget-about">
                  <p>
                    Lorem ipsum dolor sit amet consect adipisicing elit sed do
                    eiusmod temp incididunt ut labore et dolore magna aliqua. Ut
                    enim ad minim
                  </p>
                </div>
                <div class="widget-social">
                  <ul>
                    <li>
                      <a href="#"><i class="fa fa-twitter"></i></a>
                    </li>
                    <li>
                      <a href="#"><i class="fa fa-tumblr"></i></a>
                    </li>
                    <li>
                      <a href="#"><i class="fa fa-facebook"></i></a>
                    </li>
                    <li>
                      <a href="#"><i class="fa fa-instagram"></i></a>
                    </li>
                  </ul>
                </div>
              </div>
              <!-- Footer Widget End -->
            </div>
          </div>
        </div>
      </div>
      <!-- Footer Widget End -->

      <!-- Footer Copyright End -->
      <div class="copyright">
        <div class="container">
          <div class="copyright-text">
            <p>
              &copy; 2023 <span> Furbar </span> Made with
              <i class="fa fa-heart" aria-hidden="true"></i> by
              <a href="#">codecarnival</a>
            </p>
          </div>
        </div>
      </div>
      <!-- Footer Copyright End -->
    </div>
    <!-- Footer Section End -->

    <!--Back To Start-->
    <button id="backBtn" class="back-to-top">
      <i class="pe-7s-angle-up"></i>
    </button>
    <!--Back To End-->
    <!-- JS
    ============================================ -->
    <!-- <script src="../../node_modules/axios/dist/axios.min.js"></script> -->
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <!-- <script>
      function enableAddButton() {
        console.log('iiiiiiii')
        var cartDetails =  JSON.stringify(cartDetails) 
        console.log(cartDetails)
          console.log('jkjjjjjjjjj  ')
          
          const quantityInput = parseInt(document.getElementById('checkoutQuantity')).value;
          var button = document.getElementById('addButton');
          cartDetails.products.forEach((element,index) => {
           
            
            if (quantityInput <=  element.inStock) {
              button.disabled = false;
          } else {
              button.disabled = true; 
          }
          })
        
      }
  
      enableAddButton();
  </script> -->
  
  
  <script>
    
    const quantityInputs = document.querySelectorAll('.quantityInput');

quantityInputs.forEach(function(input) {
    const addButton = input.parentElement.querySelector('.add'); 
    const productId = input.dataset.productId;
    
    addButton.addEventListener('click', function() { 
        limitQuantity(productId, parseInt(input.value), addButton); 
    });
});

function limitQuantity(productId, cartQuantity, addButton) {
    axios.post('/limitQuantity', { productId })
        .then(function(response) {
            const { inStock } = response.data;
            console.log(inStock);
            const quantityInput = document.getElementById(`checkoutQuantity${productId}`);
            let currentValue = parseInt(quantityInput.value);

            if (currentValue < Math.min(5, inStock)) {
                currentValue++;
                quantityInput.value = currentValue;
            }

            if (currentValue >= Math.min(5, inStock)) {
                addButton.disabled = true;
            }

            console.log(response.data);
        })
        .catch(function(error) {
            console.error('Error:', error);
        });
}

  </script>

<script>

     document.addEventListener('DOMContentLoaded', function() {
        const quantityInputs = document.querySelectorAll('.quantityInput');

    quantityInputs.forEach(function(input) {
        const productId = input.dataset.productId;
        const addButton = input.parentElement.querySelector('.add');
        const subButton = input.parentElement.querySelector('.sub');

        addButton.addEventListener('click', function() {
            updateCart(productId, parseInt(input.value));
        });

        subButton.addEventListener('click', function() {
            updateCart(productId, parseInt(input.value));
        });

        input.addEventListener('change', function() {
            updateCart(productId, parseInt(input.value));
        });
    });

    function updateCart(productId, cartQuantity) {
        console.log("Updating cart with quantity:", cartQuantity, "for product ID:", productId);
        axios.post('/updateQuantity', { cartQuantity,productId })
            .then(function(response) {  
                const {cartTotal,productTotalPrice} =response.data
                document.getElementById('subTotal').innerHTML=`$${cartTotal}`
                document.getElementById('cartTotal').innerHTML=`$${cartTotal}`
                
                document.getElementById(`totalPrice${productId}`).innerHTML=`$${productTotalPrice}`
                console.log(cartTotal);
                console.log(response.data);
            })
            .catch(function(error) {
                console.error('Error:', error);
            })
    }
  });

  async function deleteCartProduct(productId) {
  
  axios.post('/deleteCartProduct', { productId })
  
    .then(function(response) {  
      const element = document.getElementById(`cartRefresh${productId}`)
      element.remove();
      window.location.reload();
                
     console.log(response.data);
     })
     .catch(function(error) {
       console.error('Error:', error);
       })
      }

</script>



    <!-- Modernizer & jQuery JS -->
    <script src="assets/js/vendor/modernizr-3.11.2.min.js"></script>
    <script src="assets/js/vendor/jquery-3.5.1.min.js"></script>

    <!-- Bootstrap JS -->
    <script src="assets/js/plugins/popper.min.js"></script>
    <script src="assets/js/plugins/bootstrap.min.js"></script>

    <!-- Plugins JS -->
    <script src="assets/js/plugins/swiper-bundle.min.js"></script>
    <script src="assets/js/plugins/ajax-contact.js"></script>
    <script src="assets/js/plugins/odometer.min.js"></script>
    <script src="assets/js/plugins/select2.min.js"></script>
    <script src="assets/js/plugins/ion.rangeSlider.min.js"></script>
    <script src="assets/js/plugins/jquery.zoom.min.js"></script>

    <!-- Main JS -->
    <script src="assets/js/main.js"></script>
  </body>

  <!-- Mirrored from htmldemo.net/furbar-1/furbar/cart.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 14 Dec 2023 16:16:17 GMT -->
</html>
